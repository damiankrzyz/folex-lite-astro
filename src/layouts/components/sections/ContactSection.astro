---
import type { Section } from "@/types";
import { getEntryCTM } from "@/lib/customContentLoader.astro";
import { markdownify } from "@/lib/utils/textConverter";
import overrideObjects from "@/lib/utils/overrideObjects.ts";
import ContactForm from "@/components/widgets/ContactForm.astro";

// Type for this section data
type ContactSectionType = Section & {
  title?: string;
  description?: string;
  form?: any;
};

type Props = {
  content?: ContactSectionType;
};

// Fetching the default content for the this section
let defaultContent = (
  await getEntryCTM("sections", "contact-section", Astro.currentLocale)
)?.data as ContactSectionType;

// Enables content customization with a fallback to 'defaultContent' if not provided.
let actualContent = overrideObjects(
  { ...defaultContent },
  Astro.props.content,
) as ContactSectionType;

// Extracting required values from 'content' object
let { title, description, form, enable } = actualContent as ContactSectionType;

// Don't render if disabled
if (enable === false) return null;
---

<section id="contact" class="py-16 md:py-24">
  <div class="container">
    <div class="mx-auto max-w-4xl">
      {title && (
        <h2
          class="mb-4 text-center text-4xl font-bold md:text-5xl"
          set:html={markdownify(title)}
        />
      )}
      {description && (
        <div
          class="mb-12 text-center text-lg text-gray-600"
          set:html={markdownify(description)}
        />
      )}
      {form && (
        <div class="rounded-lg bg-white p-8 shadow-lg">
          <ContactForm form={form} />
        </div>
      )}
    </div>
  </div>
</section>
